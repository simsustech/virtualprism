(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[4],{"9fe5":function(e,n,t){"use strict";t.d(n,"a",(function(){return l}));var o=t("bf93"),i=t("35c2"),r=function(e,n,t,o){function i(e){return e instanceof t?e:new t((function(n){n(e)}))}return new(t||(t=Promise))((function(t,r){function l(e){try{s(o.next(e))}catch(n){r(n)}}function a(e){try{s(o["throw"](e))}catch(n){r(n)}}function s(e){e.done?t(e.value):i(e.value).then(l,a)}s((o=o.apply(e,n||[])).next())}))};function l(e,n,t){var l,a,s,c,u,d,v,p;return r(this,void 0,void 0,(function*(){const r=new o["h"](n);if((null===(l=null===t||void 0===t?void 0:t.physics)||void 0===l?void 0:l.gravity)||(null===(a=null===t||void 0===t?void 0:t.physics)||void 0===a?void 0:a.plugin)){if(!t.physics.gravity||!t.physics.plugin)throw new Error("Please provide a gravity vector and a physics plugin");r.enablePhysics(t.physics.gravity,t.physics.plugin)}const f={left:null,right:null};if(null===(c=null===(s=null===t||void 0===t?void 0:t.xr)||void 0===s?void 0:s.controller)||void 0===c?void 0:c.model){const e=["left","right"];for(const n of e)yield o["i"].ImportMeshAsync(null,"",`models/${t.xr.controller.model}${n}.babylon`,r).then((e=>{var i,r,l,a,s,c;if(f[n]=o["e"].MergeMeshes(e.meshes),f[n]){f[n].setEnabled(!1),f[n].position=new o["l"](0,0,0);const e=new o["l"]((null===(r=null===(i=t.xr)||void 0===i?void 0:i.controller)||void 0===r?void 0:r.rotation.x)||0,(null===(a=null===(l=t.xr)||void 0===l?void 0:l.controller)||void 0===a?void 0:a.rotation.y)||0,(null===(c=null===(s=t.xr)||void 0===s?void 0:s.controller)||void 0===c?void 0:c.rotation.z)||0);f[n].rotation=e}}))}const h=new o["k"]("UniversalCamera",new o["l"](0,1.5,0),r);h.setTarget(new o["l"](0,1.5,1)),e&&h.attachControl(e,!0);const m=new o["d"]("light",new o["l"](0,1,0),r);m.intensity=.7;const b=r.createDefaultEnvironment(t.environment);b&&b.setMainColor(o["b"].FromHexString("#74b9ff"));const g=yield r.createDefaultXRExperienceAsync(Object.assign({floorMeshes:(null===b||void 0===b?void 0:b.ground)?[b.ground]:void 0,disableTeleportation:null===(u=t.xr)||void 0===u?void 0:u.teleport,inputOptions:{doNotLoadControllerMeshes:!0}},t.xr));let y;return(null===(d=t.xr)||void 0===d?void 0:d.teleport)||(g.teleportation.detach(),g.pointerSelection.detach()),(null===(v=null===t||void 0===t?void 0:t.physics)||void 0===v?void 0:v.gravity)&&(null===(p=null===t||void 0===t?void 0:t.physics)||void 0===p?void 0:p.plugin)&&(console.log("Enable WebXRControllerPhysics"),g.baseExperience.featuresManager.enableFeature(o["m"].Name,"latest",{xrInput:g.input})),g.baseExperience.onStateChangedObservable.add((e=>{e===o["n"].IN_XR&&g.baseExperience.camera.setTransformationFromNonVRCamera(h,!0)})),g.input.onControllerAddedObservable.add((e=>{e.onMotionControllerInitObservable.add((n=>{const t=n.handness;"left"!==t&&"right"!==t||f[t]&&e.grip&&(f[t].parent=e.grip,f[t].setEnabled(!0))}))})),t.virtualprism&&(y=new i["a"](r,g.baseExperience,t.virtualprism)),{scene:r,virtualprism:y,environment:b,xr:g,controllers:f}}))}},eba6:function(e,n,t){"use strict";t.r(n);var o=function(){var e=this,n=e.$createElement,t=e._self._c||n;return t("q-page",{staticClass:"column col"},[t("div",{staticClass:"column col no-wrap"},[t("canvas",{ref:"canvas",staticClass:"column col",attrs:{"touch-action":"none"}})])])},i=[],r=t("e4fd"),l=(t("752c"),t("bf93")),a=t("9fe5"),s=function(e,n,t,o){function i(e){return e instanceof t?e:new t((function(n){n(e)}))}return new(t||(t=Promise))((function(t,r){function l(e){try{s(o.next(e))}catch(n){r(n)}}function a(e){try{s(o["throw"](e))}catch(n){r(n)}}function s(e){e.done?t(e.value):i(e.value).then(l,a)}s((o=o.apply(e,n||[])).next())}))};function c(e,n,t,o){if(n){const i=l["f"].CreateSphere("bullet",{diameter:.1},e),r=n.clone("origin",null);let a;if(r){r.setEnabled(!1),r.locallyTranslate(new l["l"](0,0,.06)),i.position=r.getAbsolutePosition();const e=i.clone();e.position=new l["l"](0,1,.06),e.parent=n,a=i.getAbsolutePosition().subtract(e.getAbsolutePosition()),r.dispose(),e.dispose()}i.life=0;const s=Math.random();return i.step=()=>{i.life++,i.translate(a,1);for(const e of t)e.intersectsMesh(i)&&(i.dispose(),e.position=u(),o&&(o.detachMeshFromCamera(e),s>.9?o.attachMeshToCamera(e,"left"):s<.1&&o.attachMeshToCamera(e,"right")));i.life>100&&i.dispose()},e.onBeforeRenderObservable.add(i.step),i}}function u(){return new l["l"](10*Math.random()-5,10*Math.random(),20*Math.random()+10)}function d(e,n,t){return s(this,void 0,void 0,(function*(){const o=yield Object(a["a"])(e,n,{environment:{skyboxSize:100},virtualprism:null===t||void 0===t?void 0:t.virtualprism,xr:{teleport:!1,controller:{model:"pistol",rotation:{x:-1/8*Math.PI,y:0,z:0}}}}),i=l["f"].CreateSphere("sphere",{diameter:1},o.scene);i.position.y=1,i.position.z=5;const r={left:(new Date).getTime(),right:(new Date).getTime()};return o.xr.input.onControllerAddedObservable.add((e=>{e.onMotionControllerInitObservable.add((e=>{const n=e.getComponent("xr-standard-trigger"),t=e.handness;if(o.virtualprism&&("left"===t||"right"===t)){const e=o.controllers[t];e&&o.virtualprism.attachMeshToCamera(e,t)}n.onButtonStateChangedObservable.add((e=>{const n=(new Date).getTime();e.value>.8&&r[t]<n-200&&(c(o.scene,o.controllers[t],[i],o.virtualprism),r[t]=n)}))}))})),o}))}var v=t("0613"),p=function(e,n,t,o){function i(e){return e instanceof t?e:new t((function(n){n(e)}))}return new(t||(t=Promise))((function(t,r){function l(e){try{s(o.next(e))}catch(n){r(n)}}function a(e){try{s(o["throw"](e))}catch(n){r(n)}}function s(e){e.done?t(e.value):i(e.value).then(l,a)}s((o=o.apply(e,n||[])).next())}))},f=Object(r["defineComponent"])({name:"PageShooter",setup(){const e=Object(v["b"])(),n=Object(r["computed"])((()=>e.virtualprism.state.value.virtualprism)),t=Object(r["ref"])();let o;return Object(r["onMounted"])((()=>p(this,void 0,void 0,(function*(){if(t.value){const e=new l["c"](t.value,!0);o=yield d(t.value,e,{virtualprism:n.value}),o.virtualprism&&o.virtualprism.activate(),e.runRenderLoop((function(){o.scene.render()})),window.addEventListener("resize",(function(){e.resize()}))}})))),{canvas:t}}}),h=f,m=t("2877"),b=t("9989"),g=t("eebe"),y=t.n(g),w=Object(m["a"])(h,o,i,!1,null,null,null);n["default"]=w.exports;y()(w,"components",{QPage:b["a"]})}}]);